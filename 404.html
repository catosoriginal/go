from flask import Flask, request, jsonify

app = Flask(__name__)

secreturls = {"lm": "https://google.com"}
secretpasswords = {"lm": "pasta"}

@app.route("/")
def index():
    return "Hello World!"

@app.route("/geturl", methods=["POST"])
def get_url():
    try:
        data = request.get_json()
        key = data.get("key") if data else None
        password = data.get("password") if data else None

        if not key:
            return jsonify({"error": "Wrong arguments."}), 400

        if key not in secreturls:
            return jsonify({"error": "Invalid key."}), 403

        if key in secretpasswords:
            if not password:
                return jsonify({"error": "Wrong arguments."}), 400
            if password != secretpasswords[key]:
                return jsonify({"error": "Wrong password."}), 403

        return jsonify({"url": secreturls[key]})

    except Exception as e:
        print("Server Error:", e)
        return jsonify({"error": "Server Error"}), 500

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
